
var CrashKit={};CrashKit.report=(function(){var handlers=[];var lastException=null,lastExceptionStack=null;var subscribe=function(handler){handlers.push(handler);};var notifyHandlers=function(stack){var exception=null;for(var i in handlers)
try{handlers[i](stack);}catch(inner){exception=inner;}
if(exception){throw exception;}};var onerrorHandler=function(message,url,lineNo){var stack=null;if(lastExceptionStack){CrashKit.computeStackTrace.augmentStackTraceWithInitialElement(lastExceptionStack,url,lineNo);stack=lastExceptionStack;lastExceptionStack=null;lastException=null;}else{var location={'url':url,'line':lineNo};location.func=CrashKit.computeStackTrace.guessFunctionName(location.url,location.line);location.context=CrashKit.computeStackTrace.gatherContext(location.url,location.line);stack={'mode':'onerror','message':message,'stack':[location]};}
notifyHandlers(stack);return false;};var report=function(ex){if(lastExceptionStack){if(lastException==ex){return;}else{var s=lastExceptionStack;lastExceptionStack=null;lastException=null;notifyHandlers(s);}}
var stack=CrashKit.computeStackTrace(ex,1);lastExceptionStack=stack;lastException=ex;window.setTimeout(function(){if(lastException==ex){lastExceptionStack=null;lastException=null;notifyHandlers(stack);}},(stack.incomplete?500:1));throw ex;};window.onerror=onerrorHandler;if(typeof jQuery!='undefined'){var jQueryBind=jQuery.fn.bind;jQuery.fn.bind=function(type,data,fn){if(!fn&&data&&typeof data=='function'){fn=data;data=null;}
if(fn){var origFn=fn;var wrappedFn=function(){try{return origFn.apply(this,arguments);}catch(ex){CrashKit.report(ex);}};fn=wrappedFn;}
return jQueryBind.call(this,type,data,fn);};}
report.subscribe=subscribe;return report;})();CrashKit.computeStackTrace=(function(){var debug=false;var sourceCache={};if(typeof XMLHttpRequest=="undefined"){XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0");}catch(e){}
try{return new ActiveXObject("Msxml2.XMLHTTP.3.0");}catch(e){}
try{return new ActiveXObject("Msxml2.XMLHTTP");}catch(e){}
try{return new ActiveXObject("Microsoft.XMLHTTP");}catch(e){}
throw new Error("This browser does not support XMLHttpRequest.");};}
var loadSource=function(url){try{var request=new XMLHttpRequest();request.open("GET",url,false);request.send("");return request.responseText;}catch(e){return"";}};var getSource=function(url){if(!(url in sourceCache))
sourceCache[url]=loadSource(url).split("\n");return sourceCache[url];};var guessFunctionNameFromLines=function(lineNo,source){var reFunctionArgNames=/function ([^(]*)\(([^)]*)\)/;var reGuessFunction=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/;var line="";var maxLines=10;for(var i=0;i<maxLines;++i){line=source[lineNo-i]+line;if(line!==undefined)
{var m=reGuessFunction.exec(line);if(m){return m[1];}else{m=reFunctionArgNames.exec(line);}if(m&&m[1]){return m[1];}}}
return"?";};var guessFunctionName=function(url,lineNo){var source=getSource(url);return guessFunctionNameFromLines(lineNo,source);};var gatherContext=function(url,lineNo){var source=getSource(url);var context=[],anyDefined=false;lineNo=lineNo-1;for(var l=lineNo-2;l<=lineNo+2;l++){var item=source[l];if(typeof item!="undefined")
anyDefined=true;context.push(item);}
return(anyDefined?context:null);};var escapeRegExp=function(text){if(!arguments.callee.sRE){var specials=['/','.','*','+','?','|','(',')','[',']','{','}','\\'];arguments.callee.sRE=new RegExp('(\\'+specials.join('|\\')+')','g');}
return text.replace(arguments.callee.sRE,'\\$1');};var escapeCodeAsRegExpForMatchingInsideHTML=function(body){return escapeRegExp(body).replace('<','(?:<|&lt;)').replace('>','(?:>|&gt;)').replace('&','(?:&|&amp;)').replace('"','(?:"|&quot;)').replace(/\s+/g,'\\s+');};var findSourceInUrls=function(re,urls,singleLineExpected){for(var i in urls){var source=getSource(urls[i]);if(source){source=source.join("\n");var m=re.exec(source);if(m){var result={'url':urls[i],'line':null};result.startLine=source.substring(0,m.index).split("\n").length;if(singleLineExpected)
result.line=result.startLine;return result;}}}
return null;};var findSourceByFunctionBody=function(func){var htmlUrls=[window.location.href];var urls=[window.location.href];var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){var script=scripts[i];if(script.src)
urls.push(script.src);}
var code=""+func;var codeRE=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]+)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/;var eventRE=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/;var re;var isOneLiner=false;if(!codeRE.test(code))
re=new RegExp(escapeRegExp(code));else{var name=RegExp.$1,args=RegExp.$2,body=RegExp.$3;args=args.split(",").join("\\s*,\\s*");name=(name?"\\s+"+name:'');isOneLiner=(body.split("\n").length==1);body=escapeRegExp(body).replace(/;$/,';?').replace(/\s+/g,'\\s+');re=new RegExp("function"+name+"\\s*\\("+args+"\\)\\s*{\\s*"+body+"\\s*}");}
var result=findSourceInUrls(re,urls,isOneLiner);if(result)return result;if(eventRE.test(code)){var event=RegExp.$1,body=RegExp.$2;body=escapeCodeAsRegExpForMatchingInsideHTML(body);re=new RegExp("on"+event+'=[\\\'"]\\s*'+body+'\\s*[\\\'"]','i');result=findSourceInUrls(re,urls,true);if(result)return result;re=new RegExp(body);result=findSourceInUrls(re,urls,true);if(result)return result;}
if(window.console)
console.info("Function code not found in HTML and all SCRIPTs (please contact CrashKit support):\n"+code);return null;};var computeStackTraceFromFirefoxStackProp=function(ex){if(!ex.stack)
return null;var lineRE=/^\s*(?:(\w*)\(.*\))?@((?:file|http).*):(\d+)\s*$/i;var lines=ex.stack.split("\n");var stack=[];for(var i in lines){var line=lines[i];if(lineRE.test(line)){var element={'url':RegExp.$2,'func':RegExp.$1,'line':RegExp.$3};if(!element.func&&element.line)
element.func=guessFunctionName(element.url,element.line);if(element.line)
element.context=gatherContext(element.url,element.line);stack.push(element);}}
if(!stack.length)
return null;return{'mode':'firefox','name':ex.name,'message':ex.message,'stack':stack};};var computeStackTraceFromOperaMultiLineMessage=function(ex){var lines=ex.message.split("\n");if(lines.length<4)
return null;var lineRE1=/^\s*Line (\d+) of linked script ((?:file|http)\S+)(?:: in function (\S+))?\s*$/i,lineRE2=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http)\S+)(?:: in function (\S+))?\s*$/i,lineRE3=/^\s*Line (\d+) of function script\s*$/i;var stack=[];var scripts=document.getElementsByTagName('script');var inlineScriptBlocks=[];for(var i in scripts)
if(!scripts[i].src)
inlineScriptBlocks.push(scripts[i]);for(var i=2,len=lines.length;i<len;i+=2){var item=null;if(lineRE1.test(lines[i]))
item={'url':RegExp.$2,'func':RegExp.$3,'line':RegExp.$1};else if(lineRE2.test(lines[i])){item={'url':RegExp.$3,'func':RegExp.$4};var relativeLine=(RegExp.$1-0);var script=inlineScriptBlocks[RegExp.$2-1];if(script){var source=getSource(item.url);if(source){source=source.join("\n");var pos=source.indexOf(script.innerText);if(pos>=0){item.line=relativeLine+source.substring(0,pos).split("\n").length;}}}}else if(lineRE3.test(lines[i])){var url=window.location.href.replace(/#.*$/,''),line=RegExp.$1;var re=new RegExp(escapeCodeAsRegExpForMatchingInsideHTML(lines[i+1]));var source=findSourceInUrls(re,[url],true);if(source)
item={'url':url,'line':source.line,'func':''};}
if(item){if(!item.func)
item.func=guessFunctionName(item.url,item.line);var context=gatherContext(item.url,item.line);var midline=(context?context[Math.floor(context.length/2)]:null);if(context&&midline.replace(/^\s*/,'')==lines[i+1].replace(/^\s*/,''))
item.context=context;else{item.context=[lines[i+1]];}
stack.push(item);}}
if(!stack.length)
return null;return{'mode':'opera','name':ex.name,'message':lines[0],'stack':stack};};var augmentStackTraceWithInitialElement=function(stackInfo,url,lineNo){var initial={'url':url,'line':lineNo};if(initial.url&&initial.line){stackInfo.incomplete=false;if(!initial.func)
initial.func=guessFunctionName(initial.url,initial.line);if(!initial.context)
initial.context=gatherContext(initial.url,initial.line);if(stackInfo.stack.length>0)
if(stackInfo.stack[0].url==initial.url)
if(stackInfo.stack[0].line==initial.line){return;}else if(!stackInfo.stack[0].line&&stackInfo.stack[0].func==initial.func){stackInfo.stack[0].line=initial.line;stackInfo.stack[0].context=initial.context;return;}
stackInfo.stack.splice(0,0,initial);stackInfo.partial=true;return true;}else{stackInfo.incomplete=true;}};var computeStackTraceByWalkingCallerChain=function(ex,depth){var fnRE=/function\s*([\w\-$]+)?\s*\(/i;var stack=[];var funcs={},recursion=false;for(var curr=arguments.callee.caller;curr&&!recursion;curr=curr.caller){var fn=curr.name||'';if(!fn)
fn=fnRE.test(curr.toString())?RegExp.$1||'':'';var source=findSourceByFunctionBody(curr);var url=null,line=null;if(source){url=source.url;line=source.line;if(!fn)
fn=guessFunctionName(url,source.startLine);}
recursion=!!funcs[curr];funcs[curr]=true;var item={'url':url,'func':fn,'line':line};if(recursion)item.recursion=true;stack.push(item);}
stack.splice(0,depth);var result={'mode':'callers','name':ex.name,'message':ex.message,'stack':stack};augmentStackTraceWithInitialElement(result,ex.sourceURL||ex.fileName,ex.line||ex.lineNumber);return result;};var computeStackTrace=function(ex,depth){var stack=null;depth=(typeof depth=='undefined'?0:depth-0);try{stack=computeStackTraceFromFirefoxStackProp(ex);if(stack)return stack;}catch(e){if(debug)throw e;}
try{stack=computeStackTraceFromOperaMultiLineMessage(ex);if(stack)return stack;}catch(e){if(debug)throw e;}
try{stack=computeStackTraceByWalkingCallerChain(ex,depth+1);if(stack)return stack;}catch(e){if(debug)throw e;}
return{'mode':'failed'};};var computeStackTraceOfCaller=function(depth){depth=(typeof depth=='undefined'?0:depth-0)+1;try{(0)();}catch(ex){return computeStackTrace(ex,depth+1);}};computeStackTrace.augmentStackTraceWithInitialElement=augmentStackTraceWithInitialElement;computeStackTrace.guessFunctionName=guessFunctionName;computeStackTrace.gatherContext=gatherContext;computeStackTrace.ofCaller=computeStackTraceOfCaller;return computeStackTrace;})();(function(){var crashKitHost=null;var webServiceUrl=null;var computeWebServiceUrl=function(){var els=document.getElementsByTagName("SCRIPT");for(var i=0;i<els.length;i++){var el=els[i];var src=el.src;if(src&&src.indexOf("crashkit-javascript.js?")>=0){crashKitHost=src.substring(src.indexOf("://")+3);crashKitHost=crashKitHost.substring(0,crashKitHost.indexOf("/"));var x=src.substring(src.indexOf("?")+1).split("/");var proto=(("https:"==document.location.protocol)?"https://":"http://");webServiceUrl=proto+crashKitHost+"/"+x[0]+"/products/"+x[1]+"/post-report/0/0";}}};var encodeJSON=function(){var c={"\b":"b","\t":"t","\n":"n","\f":"f","\r":"r",'"':'"',"\\":"\\","/":"/"},d=function(n){return n<10?"0".concat(n):n},e=function(c,f,e){e=eval;delete eval;if(typeof eval==="undefined")eval=e;f=eval(""+c);eval=e;return f},i=function(e,p,l){return 1*e.substr(p,l)},p=["","000","00","0",""],rc=null,rd=/^[0-9]{4}\-[0-9]{2}\-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}$/,rt=/^([0-9]+|[0-9]+[,\.][0-9]{1,3})$/,rs=/(\x5c|\x2F|\x22|[\x0c-\x0d]|[\x08-\x0a])/g,s=function(i,d){return"\\".concat(c[d])},ru=/([\x00-\x07]|\x0b|[\x0e-\x1f])/g,u=function(i,d){var n=d.charCodeAt(0).toString(16);return"\\u".concat(p[n.length],n)},v=function(k,v){return $[typeof result](result)!==Function&&(v.hasOwnProperty?v.hasOwnProperty(k):v.constructor.prototype[k]!==v[k])},$={"boolean":function(){return Boolean},"function":function(){return Function},"number":function(){return Number},"object":function(o){return o instanceof o.constructor?o.constructor:null},"string":function(){return String},"undefined":function(){return null}},$$=function(m){function $(c,t){t=c[m];delete c[m];try{e(c)}catch(z){c[m]=t;return 1}};return $(Array)&&$(Object)};try{rc=new RegExp('^("(\\\\.|[^"\\\\\\n\\r])*?"|[,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t])+?$')}
catch(z){rc=/^(true|false|null|\[.*\]|\{.*\}|".*"|\d+|\d+\.\d+)$/};var encodeJSON=function(self){if(self===null)return"null";if(self===undefined)return"null";var result,type=typeof self;var tmp=$[type](self);if(tmp==null)return null;switch(tmp){case Array:result=[];for(var i=0,j=0,k=self.length;j<k;j++){if(self[j]!==undefined&&(tmp=encodeJSON(self[j])))
result[i++]=tmp;};return"[".concat(result.join(","),"]");case Boolean:return String(self);case Date:return'"'.concat(self.getFullYear(),'-',d(self.getMonth()+1),'-',d(self.getDate()),'"');case Function:return"";case Number:return isFinite(self)?String(self):"null";case String:return'"'.concat(self.replace(rs,s).replace(ru,u),'"');default:var i=0,key;result=[];for(key in self){if(self[key]!==undefined&&(tmp=encodeJSON(self[key])))
result[i++]='"'.concat(key.replace(rs,s).replace(ru,u),'":',tmp);};return"{".concat(result.join(","),"}");}};return encodeJSON;}();var encodeError=function(stack){return encodeJSON([{"userActionOrScreenNameOrBackgroundProcess":'',"severity":"major","exception":stack,"data":{"cookie":document.cookie,"url":window.location.href},"env":{"user_agent":navigator.userAgent,"opera":!!window.opera,"vendor":navigator.vendor,"platform":navigator.platform},"language":"javascript"}]);};var sendPayload=function(text){var request=new XMLHttpRequest();request.open("POST",webServiceUrl,false);request.setRequestHeader("Content-Type","text/plain;charset=UTF-8");request.send(text);if(!request.getResponseHeader("Date")||request.status!=200){}};var sendToCrashKit=function(stack){if(webServiceUrl==null)
computeWebServiceUrl();if(webServiceUrl==null)
return;var json=encodeError(stack);if(window.console)
window.console.info("Error report sent to "+crashKitHost+":\n"+json);sendPayload(json);};CrashKit.report.subscribe(sendToCrashKit);})();